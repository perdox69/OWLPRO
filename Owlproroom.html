<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏ß (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ô‡∏¥‡∏™‡∏¥‡∏ï)</title>
    <style>
        body { font-family: 'Sarabun', sans-serif; background-color: #f0f4f8; padding: 20px; }
        .container { max-width: 600px; margin: 0 auto; background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: #2c3e50; }
        .form-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; font-weight: bold; color: #34495e; }
        input, select { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 6px; box-sizing: border-box; font-size: 16px; }
        
        .btn-submit { width: 100%; padding: 14px; background-color: #3498db; color: white; border: none; border-radius: 6px; font-size: 16px; cursor: pointer; transition: 0.3s; }
        .btn-submit:hover { background-color: #2980b9; }

        .time-preview { background: #e8f6f3; color: #16a085; padding: 10px; border-radius: 6px; margin-top: 5px; font-size: 0.9em; display: none; }
        
        .busy-list { margin-top: 30px; border-top: 2px solid #eee; padding-top: 20px; }
        .busy-item { background: #fff5f5; color: #c0392b; padding: 8px 12px; border-radius: 4px; margin-bottom: 5px; font-size: 14px; border-left: 4px solid #c0392b; }
    </style>
</head>
<body>

<div class="container">
    <h1>üìÖ ‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠</h1>
    <p style="text-align:center; color:#7f8c8d;">‡∏à‡∏≠‡∏á‡πÑ‡∏î‡πâ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏•‡∏∞ 3 ‡∏ä‡∏°. (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏≠‡∏á‡πÑ‡∏î‡πâ)</p>
    
    <div class="form-group">
        <label>‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏à‡∏≠‡∏á:</label>
        <input type="text" id="inpName" placeholder="‡πÄ‡∏ä‡πà‡∏ô 66xxxxxxxx ‡∏™‡∏°‡∏ä‡∏≤‡∏¢">
    </div>

    <div class="form-group">
        <label>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á:</label>
        <select id="inpRoom" onchange="updateBusyList()">
            <option value="Room A">Room A (‡∏´‡πâ‡∏≠‡∏á‡πÉ‡∏´‡∏ç‡πà)</option>
            <option value="Room B">Room B (‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏•‡πá‡∏Å)</option>
        </select>
    </div>

    <div class="form-group">
        <label>‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏¥‡πà‡∏°:</label>
        <input type="time" id="inpTime" onchange="calcEndTime()">
        <div id="timePreview" class="time-preview"></div>
    </div>

    <button class="btn-submit" onclick="saveBooking()">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</button>

    <div class="busy-list">
        <h3>üö´ ‡∏Ñ‡∏¥‡∏ß‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏á <span id="lblRoom">Room A</span></h3>
        <div id="listContainer">Loading...</div>
    </div>
</div>

<script>
    const STORAGE_KEY = 'uni_room_data'; // ‡∏Å‡∏∏‡∏ç‡πÅ‡∏à‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ 2 ‡πÑ‡∏ü‡∏•‡πå‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ô‡∏£‡∏π‡πâ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á
    const DURATION = 3; // 3 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á

    function getBookings() {
        return JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
    }

    function timeToMin(t) {
        const [h, m] = t.split(':').map(Number);
        return h * 60 + m;
    }

    function minToTime(min) {
        let h = Math.floor(min / 60);
        let m = min % 60;
        if (h >= 24) h -= 24;
        return `${h.toString().padStart(2,'0')}:${m.toString().padStart(2,'0')}`;
    }

    function calcEndTime() {
        const start = document.getElementById('inpTime').value;
        if (!start) return;
        
        const endMin = timeToMin(start) + (DURATION * 60);
        const endStr = minToTime(endMin);
        
        const preview = document.getElementById('timePreview');
        preview.style.display = 'block';
        preview.innerHTML = `‡πÄ‡∏ß‡∏•‡∏≤‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì: <b>${start} - ${endStr}</b>`;
    }

    function updateBusyList() {
        const room = document.getElementById('inpRoom').value;
        document.getElementById('lblRoom').innerText = room;
        
        const bookings = getBookings();
        const container = document.getElementById('listContainer');
        container.innerHTML = '';

        const roomBookings = bookings.filter(b => b.room === room).sort((a,b) => a.startMin - b.startMin);

        if (roomBookings.length === 0) {
            container.innerHTML = '<p style="color:#999;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏ô‡∏à‡∏≠‡∏á ‡∏ß‡πà‡∏≤‡∏á‡∏ï‡∏•‡∏≠‡∏î‡∏ß‡∏±‡∏ô</p>';
        } else {
            roomBookings.forEach(b => {
                const div = document.createElement('div');
                div.className = 'busy-item';
                div.innerText = `${b.start} - ${b.end} : ${b.name}`;
                container.appendChild(div);
            });
        }
    }

    function saveBooking() {
        const name = document.getElementById('inpName').value.trim();
        const room = document.getElementById('inpRoom').value;
        const start = document.getElementById('inpTime').value;

        if (!name || !start) { alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö"); return; }

        const startMin = timeToMin(start);
        const endMin = startMin + (DURATION * 60);
        const bookings = getBookings();

        // Check Overlap
        const isOverlap = bookings.filter(b => b.room === room).some(b => {
            return (startMin < b.endMin && endMin > b.startMin);
        });

        if (isOverlap) {
            alert("‚ùå ‡∏à‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ! ‡πÄ‡∏ß‡∏•‡∏≤‡∏ô‡∏µ‡πâ‡∏ä‡∏ô‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ô‡∏≠‡∏∑‡πà‡∏ô");
        } else {
            bookings.push({
                id: Date.now(),
                name, room, start, 
                end: minToTime(endMin),
                startMin, endMin
            });
            localStorage.setItem(STORAGE_KEY, JSON.stringify(bookings));
            alert("‚úÖ ‡∏à‡∏≠‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!");
            window.location.reload(); // ‡∏£‡∏µ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        }
    }

    // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
    updateBusyList();
</script>
</body>
</html>