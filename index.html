<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #1a237e; /* ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏Ç‡πâ‡∏° */
            --primary-light: #534bae;
            --accent-color: #00e5ff; /* ‡∏ü‡πâ‡∏≤‡∏™‡∏ß‡πà‡∏≤‡∏á‡∏™‡∏î‡πÉ‡∏™ */
            --text-dark: #212121;
            --text-muted: #757575;
            --white: #ffffff;
            --success: #00c853;
            --danger: #ff1744;
            --shadow-md: 0 8px 30px rgba(0,0,0,0.12);
            --shadow-lg: 0 20px 60px rgba(0,0,0,0.2);
            --radius-md: 16px;
            --radius-lg: 24px;
            --radius-pill: 50px;
        }

        body {
            font-family: 'Poppins', sans-serif;
            /* ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏†‡∏≤‡∏û‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á */
            background-image: url('image_7.png');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            margin: 0;
            padding: 40px 20px;
            color: var(--text-dark);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* ‡πÄ‡∏û‡∏¥‡πà‡∏° Overlay ‡∏™‡∏µ‡∏î‡∏≥‡∏à‡∏≤‡∏á‡πÜ ‡∏ó‡∏±‡∏ö‡∏†‡∏≤‡∏û‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏á‡πà‡∏≤‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô */
        body::before {
            content: '';
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0, 0, 0, 0.5); /* ‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏°‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà */
            z-index: -1;
        }

        .container {
            max-width: 700px;
            width: 100%;
            background: rgba(255, 255, 255, 0.95); /* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏Ç‡∏≤‡∏ß‡πÇ‡∏õ‡∏£‡πà‡∏á‡πÅ‡∏™‡∏á */
            padding: 50px;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-lg);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px); /* ‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡∏Å‡∏£‡∏∞‡∏à‡∏Å‡∏ù‡πâ‡∏≤ (‡∏ñ‡πâ‡∏≤‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö) */
        }

        /* ‡πÄ‡∏™‡πâ‡∏ô‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô */
        .container::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0;
            height: 8px;
            background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
        }

        h1 {
            text-align: center;
            color: var(--primary-color);
            font-weight: 800;
            margin-bottom: 40px;
            font-size: 2.2rem;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        h1 span {
            color: var(--accent-color);
            background: -webkit-linear-gradient(45deg, var(--accent-color), #00b0ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* Form Styles */
        .form-section {
            margin-bottom: 40px;
            background: #fff;
            padding: 30px;
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-md);
        }

        .section-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            letter-spacing: 0.5px;
        }
        
        .section-title::before {
            content: '';
            display: inline-block;
            width: 6px;
            height: 24px;
            background: linear-gradient(to bottom, var(--primary-color), var(--accent-color));
            margin-right: 12px;
            border-radius: 4px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            font-size: 0.95rem;
            color: var(--primary-color);
        }

        input[type="text"], input[type="tel"], input[type="number"], select {
            width: 100%;
            padding: 14px 18px;
            border: 2px solid #eef2f7;
            border-radius: var(--radius-md);
            font-family: 'Poppins', sans-serif;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: #f8faff;
            box-sizing: border-box;
            color: var(--text-dark);
        }

        input:focus, select:focus {
            outline: none;
            border-color: var(--accent-color);
            background: var(--white);
            box-shadow: 0 0 0 5px rgba(0, 229, 255, 0.15);
        }

        #yearGroup { display: none; }

        /* --- Time Grid --- */
        .loading-spinner {
            border: 4px solid rgba(26, 35, 126, 0.1);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border-left-color: var(--accent-color);
            animation: spin 1s cubic-bezier(0.68, -0.55, 0.27, 1.55) infinite;
            margin: 20px auto;
            display: none;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(95px, 1fr));
            gap: 12px;
            margin-top: 20px;
        }

        .time-slot {
            padding: 12px 5px;
            border: 2px solid #eef2f7;
            border-radius: var(--radius-pill);
            text-align: center;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 600;
            background: var(--white);
            color: var(--text-muted);
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            position: relative;
            overflow: hidden;
            box-shadow: 0 2px 6px rgba(0,0,0,0.04);
        }

        .time-slot:hover:not(.disabled) {
            border-color: var(--accent-color);
            color: var(--accent-color);
            background: rgba(0, 229, 255, 0.08);
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 229, 255, 0.15);
        }

        .time-slot.selected {
            background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
            color: var(--white);
            border-color: transparent;
            box-shadow: 0 8px 20px rgba(0, 229, 255, 0.3);
            transform: scale(1.08);
            z-index: 2;
        }

        .time-slot.range {
            background: rgba(0, 229, 255, 0.12);
            border-color: var(--accent-color);
            color: var(--primary-color);
            font-weight: 700;
        }

        .time-slot.disabled {
            background: #f5f5f5;
            color: #bdbdbd;
            border-color: #f0f0f0;
            cursor: not-allowed;
            box-shadow: none;
            opacity: 0.8;
        }
        .time-slot.disabled::after {
            content: '';
            position: absolute;
            top: 50%; left: 50%;
            width: 100%; height: 2px;
            background: #e0e0e0;
            transform: translate(-50%, -50%) rotate(-25deg);
        }

        #preview {
            text-align: center;
            margin-top: 25px;
            font-weight: 700;
            color: var(--primary-color);
            padding: 15px;
            background: linear-gradient(to right, rgba(0, 229, 255, 0.1), rgba(26, 35, 126, 0.05));
            border-radius: var(--radius-md);
            border-left: 5px solid var(--accent-color);
            display: none;
            font-size: 1.05rem;
        }

        /* Consent Box */
        .consent-box {
            background: linear-gradient(to right, #fffde7, #fff9c4);
            border: none;
            border-left: 5px solid #ffc107;
            padding: 30px;
            border-radius: var(--radius-md);
            margin-top: 40px;
            box-shadow: var(--shadow-md);
        }

        .consent-title {
            color: #f57f17;
            font-weight: 800;
            margin-bottom: 20px;
            display: block;
            font-size: 1.1rem;
        }

        .consent-list {
            font-size: 0.95rem;
            color: #4527a0;
            margin-bottom: 25px;
            padding-left: 25px;
            line-height: 1.7;
        }
        .consent-list li { margin-bottom: 10px; }

        .radio-group { display: flex; gap: 30px; }
        .radio-option { display: flex; align-items: center; cursor: pointer; position: relative; font-weight: 600; color: #4527a0; }
        .radio-option input { position: absolute; opacity: 0; cursor: pointer; }
        .checkmark {
            position: relative;
            height: 24px; width: 24px;
            background-color: var(--white);
            border-radius: 50%;
            margin-right: 12px;
            transition: 0.3s;
            border: 2px solid #b0bec5;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        .radio-option:hover .checkmark { border-color: var(--accent-color); background: #f0faff; }
        .radio-option input:checked ~ .checkmark {
            background-color: var(--success);
            border-color: var(--success);
            box-shadow: 0 4px 10px rgba(0, 200, 83, 0.3);
        }
        .checkmark:after {
            content: "";
            position: absolute;
            display: none;
        }
        .radio-option input:checked ~ .checkmark:after {
            display: block;
            top: 7px; left: 7px;
            width: 10px; height: 10px;
            border-radius: 50%;
            background: white;
            animation: popIn 0.2s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        @keyframes popIn { from { transform: scale(0); } to { transform: scale(1); } }

        /* Button */
        .btn-submit {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, var(--primary-color), #0091ea);
            color: var(--white);
            border: none;
            border-radius: var(--radius-pill);
            font-size: 1.2rem;
            font-weight: 800;
            font-family: 'Poppins', sans-serif;
            cursor: pointer;
            margin-top: 40px;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            box-shadow: 0 10px 30px rgba(26, 35, 126, 0.3);
            letter-spacing: 1px;
        }

        .btn-submit:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 15px 40px rgba(26, 35, 126, 0.4);
            background: linear-gradient(135deg, var(--primary-light), var(--accent-color));
        }
        .btn-submit:active { transform: translateY(-2px) scale(0.98); }
        .btn-submit:disabled {
            background: #cfd8dc;
            box-shadow: none;
            cursor: not-allowed;
            transform: none;
            color: #90a4ae;
        }

        /* Responsive */
        @media (max-width: 768px) {
            body { padding: 20px 10px; }
            .container { padding: 30px 20px; }
            h1 { font-size: 1.8rem; }
        }
        @media (max-width: 480px) {
            .grid-container { grid-template-columns: repeat(3, 1fr); }
            .radio-group { flex-direction: column; gap: 15px; }
        }
    </style>
</head>
<body>

<div class="container">
    <h1>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô<span>‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</span></h1>

    <div class="form-section">
        <div class="section-title">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</div>
        <div class="form-group">
            <label>1. ‡∏ä‡∏∑‡πà‡∏≠ - ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• *</label>
            <input type="text" id="inpName" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡∏à‡∏£‡∏¥‡∏á">
        </div>
        <div class="form-group">
            <label>2. ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå *</label>
            <input type="tel" id="inpPhone" placeholder="08x-xxxxxxx">
        </div>
        
        <div class="form-group">
            <label>3. ‡∏™‡∏ñ‡∏≤‡∏ô‡∏†‡∏≤‡∏û *</label>
            <select id="inpStatus" onchange="handleStatusChange()">
                <option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
                <option value="‡∏≠‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå">‡∏≠‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå</option>
                <option value="‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà">‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà</option>
                <option value="‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤">‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤</option>
                <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
            </select>
        </div>
        
        <div class="form-group" id="yearGroup">
            <label>4. ‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ (‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤)</label>
            <select id="inpYear">
                <option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
                <option value="‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà 1">‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà 1</option>
                <option value="‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà 2">‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà 2</option>
                <option value="‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà 3">‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà 3</option>
                <option value="‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà 4">‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà 4</option>
            </select>
        </div>

        <div class="form-group">
            <label>5. ‡∏Ñ‡∏ì‡∏∞/‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô *</label>
            <select id="inpFaculty">
                <option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
                <option value="‡∏™‡∏†‡∏≤‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢">‡∏™‡∏†‡∏≤‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢</option>
                <option value="‡∏Ñ‡∏ì‡∏∞‡∏Ñ‡∏£‡∏∏‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå">‡∏Ñ‡∏ì‡∏∞‡∏Ñ‡∏£‡∏∏‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå</option>
                <option value="‡∏Ñ‡∏ì‡∏∞‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡πÅ‡∏•‡∏∞‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ">‡∏Ñ‡∏ì‡∏∞‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡πÅ‡∏•‡∏∞‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ</option>
                <option value="‡∏Ñ‡∏ì‡∏∞‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£">‡∏Ñ‡∏ì‡∏∞‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</option>
                <option value="‡∏Ñ‡∏ì‡∏∞‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡πÅ‡∏•‡∏∞‡∏™‡∏±‡∏á‡∏Ñ‡∏°‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå">‡∏Ñ‡∏ì‡∏∞‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡πÅ‡∏•‡∏∞‡∏™‡∏±‡∏á‡∏Ñ‡∏°‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå</option>
                <option value="‡∏Ñ‡∏ì‡∏∞‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå">‡∏Ñ‡∏ì‡∏∞‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå</option>
                <option value="‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡πà‡∏≠‡∏á‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡πà‡∏≠‡∏á‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</option>
                <option value="‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏∑‡∏≠‡∏ô">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏∑‡∏≠‡∏ô</option>
                <option value="‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏∑‡∏≠‡∏á">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏∑‡∏≠‡∏á</option>
                <option value="‡∏ö‡∏±‡∏ì‡∏ë‡∏¥‡∏ï‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢">‡∏ö‡∏±‡∏ì‡∏ë‡∏¥‡∏ï‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢</option>
                <option value="‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏≤‡∏ò‡∏¥‡∏ï‡∏•‡∏∞‡∏≠‡∏≠‡∏≠‡∏∏‡∏ó‡∏¥‡∏®">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏≤‡∏ò‡∏¥‡∏ï‡∏•‡∏∞‡∏≠‡∏≠‡∏≠‡∏∏‡∏ó‡∏¥‡∏®</option>
                <option value="‡∏™‡∏ß‡∏ô‡∏î‡∏∏‡∏™‡∏¥‡∏ï‡πÇ‡∏û‡∏•">‡∏™‡∏ß‡∏ô‡∏î‡∏∏‡∏™‡∏¥‡∏ï‡πÇ‡∏û‡∏•</option>
                <option value="‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏ß‡∏¥‡∏ó‡∏¢‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏™‡∏≤‡∏£‡∏™‡∏ô‡πÄ‡∏ó‡∏®">‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏ß‡∏¥‡∏ó‡∏¢‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏™‡∏≤‡∏£‡∏™‡∏ô‡πÄ‡∏ó‡∏®</option>
                <option value="‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏™‡πà‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏ß‡∏¥‡∏ä‡∏≤‡πÅ‡∏•‡∏∞‡∏á‡∏≤‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô">‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏™‡πà‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏ß‡∏¥‡∏ä‡∏≤‡πÅ‡∏•‡∏∞‡∏á‡∏≤‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</option>
                <option value="‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢">‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢</option>
                <option value="‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡πÄ‡∏®‡∏©">‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡πÄ‡∏®‡∏©</option>
                <option value="‡∏™‡∏ñ‡∏≤‡∏ö‡∏±‡∏ô‡∏†‡∏≤‡∏©‡∏≤/‡∏®‡∏¥‡∏•‡∏õ‡∏∞‡πÅ‡∏•‡∏∞‡∏ß‡∏±‡∏í‡∏ô‡∏ò‡∏£‡∏£‡∏°">‡∏™‡∏ñ‡∏≤‡∏ö‡∏±‡∏ô‡∏†‡∏≤‡∏©‡∏≤/‡∏®‡∏¥‡∏•‡∏õ‡∏∞‡πÅ‡∏•‡∏∞‡∏ß‡∏±‡∏í‡∏ô‡∏ò‡∏£‡∏£‡∏°</option>
                <option value="‡∏™‡∏ñ‡∏≤‡∏ö‡∏±‡∏ô‡∏ß‡∏¥‡∏à‡∏±‡∏¢‡πÅ‡∏•‡∏∞‡∏û‡∏±‡∏í‡∏ô‡∏≤">‡∏™‡∏ñ‡∏≤‡∏ö‡∏±‡∏ô‡∏ß‡∏¥‡∏à‡∏±‡∏¢‡πÅ‡∏•‡∏∞‡∏û‡∏±‡∏í‡∏ô‡∏≤</option>
                <option value="‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ó‡∏∏‡∏ô‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå">‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ó‡∏∏‡∏ô‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå</option>
                <option value="‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏™‡∏¥‡πà‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Å‡∏£‡∏≤‡∏ü‡∏ü‡∏¥‡∏Ñ‡πÑ‡∏ã‡∏ó‡πå">‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏™‡∏¥‡πà‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Å‡∏£‡∏≤‡∏ü‡∏ü‡∏¥‡∏Ñ‡πÑ‡∏ã‡∏ó‡πå</option>
                <option value="‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏¢‡∏∏‡∏ó‡∏ò‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡πÅ‡∏•‡∏∞‡πÅ‡∏ú‡∏ô">‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏¢‡∏∏‡∏ó‡∏ò‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡πÅ‡∏•‡∏∞‡πÅ‡∏ú‡∏ô</option>
                <option value="‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢">‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢</option>
                <option value="‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πà‡∏ß‡∏°‡∏°‡∏∑‡∏≠‡∏ó‡∏≤‡∏á‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£">‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πà‡∏ß‡∏°‡∏°‡∏∑‡∏≠‡∏ó‡∏≤‡∏á‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£</option>
                <option value="‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏™‡∏ô‡πÄ‡∏ó‡∏®‡πÅ‡∏ô‡∏∞‡πÅ‡∏ô‡∏ß‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏•‡∏∞‡∏≠‡∏≤‡∏ä‡∏µ‡∏û">‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏™‡∏ô‡πÄ‡∏ó‡∏®‡πÅ‡∏ô‡∏∞‡πÅ‡∏ô‡∏ß‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏•‡∏∞‡∏≠‡∏≤‡∏ä‡∏µ‡∏û</option>
                <option value="‡∏™‡∏†‡∏≤‡∏Ñ‡∏ì‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå‡πÅ‡∏•‡∏∞‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô">‡∏™‡∏†‡∏≤‡∏Ñ‡∏ì‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå‡πÅ‡∏•‡∏∞‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</option>
                <option value="‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå">‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå</option>
                <option value="‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ó‡∏≤‡∏á‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£‡∏™‡∏ß‡∏ô‡∏î‡∏∏‡∏™‡∏¥‡∏ï">‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ó‡∏≤‡∏á‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£‡∏™‡∏ß‡∏ô‡∏î‡∏∏‡∏™‡∏¥‡∏ï</option>
                <option value="‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÅ‡∏õ‡∏£‡∏£‡∏π‡∏õ ‡∏°‡∏™‡∏î.">‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÅ‡∏õ‡∏£‡∏£‡∏π‡∏õ ‡∏°‡∏™‡∏î.</option>
                <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
            </select>
        </div>
    </div>

    <div class="form-section">
        <div class="section-title">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</div>
        <div class="form-group">
            <label>6. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° (‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Real-time)</label>
            <select id="inpRoom" onchange="fetchData()">
                <option value="Sharing Room (‡∏ä‡∏±‡πâ‡∏ô 1) (‡πÄ‡∏ß‡∏•‡∏≤ 07.30 - 19.00 ‡∏ô.)">Sharing Room (‡∏ä‡∏±‡πâ‡∏ô 1) (‡πÄ‡∏ß‡∏•‡∏≤ 07.30 - 19.00 ‡∏ô.)</option>
                <option value="The Library Cafe (‡πÄ‡∏•‡πá‡∏Å) ‡∏ä‡∏±‡πâ‡∏ô 2 (‡πÄ‡∏ß‡∏•‡∏≤ 08.30 - 16.30 ‡∏ô.)">The Library Cafe (‡πÄ‡∏•‡πá‡∏Å) ‡∏ä‡∏±‡πâ‡∏ô 2 (‡πÄ‡∏ß‡∏•‡∏≤ 08.30 - 16.30 ‡∏ô.)</option>
            </select>
        </div>

        <div class="form-group">
            <label style="margin-bottom: 15px;">7. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏° (‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏≠‡∏á 3 ‡∏ä‡∏°. ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥):</label>
            
            <div id="loading" class="loading-spinner"></div>
            <div id="grid" class="grid-container"></div>
            <div id="preview"></div>
        </div>

        <div class="form-group">
            <label>8. ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (‡∏Ñ‡∏ô) *</label>
            <input type="number" id="inpUsers" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏≥‡∏ô‡∏ß‡∏ô (‡πÄ‡∏ä‡πà‡∏ô 5)" min="1">
        </div>

        <div class="form-group">
            <label>9. ‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô *</label>
            <select id="inpUsage">
                <option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
                <option value="‡∏ï‡∏¥‡∏ß / ‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏Å‡∏•‡∏∏‡πà‡∏°">‡∏ï‡∏¥‡∏ß / ‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏Å‡∏•‡∏∏‡πà‡∏°</option>
                <option value="‡∏à‡∏±‡∏î‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° / ‡πÄ‡∏ß‡∏¥‡∏£‡πå‡∏Ñ‡∏ä‡πá‡∏≠‡∏õ (Workshop)">‡∏à‡∏±‡∏î‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° / ‡πÄ‡∏ß‡∏¥‡∏£‡πå‡∏Ñ‡∏ä‡πá‡∏≠‡∏õ (Workshop)</option>
                <option value="‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå / ‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå (Online Meeting)">‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå / ‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå (Online Meeting)</option>
                <option value="‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß (‡πÄ‡∏ä‡πà‡∏ô ‡∏≠‡πà‡∏≤‡∏ô‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠, ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏á‡∏µ‡∏¢‡∏ö‡πÜ)">‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß (‡πÄ‡∏ä‡πà‡∏ô ‡∏≠‡πà‡∏≤‡∏ô‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠, ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏á‡∏µ‡∏¢‡∏ö‡πÜ)</option>
                <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
            </select>
        </div>
    </div>

    <div class="consent-box">
        <label class="consent-title">‡∏Ç‡πâ‡∏≠‡∏ï‡∏Å‡∏•‡∏á‡πÅ‡∏•‡∏∞‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô *</label>
        <ul class="consent-list">
            <li>1. ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏≤‡∏ô‡πå‡πÄ‡∏ï‡∏≠‡∏£‡πå Floor Supervisor</li>
            <li>2. ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏•‡∏∞ 3 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á</li>
            <li>3. ‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ‡∏ô‡∏≥‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏ó‡∏≤‡∏ô‡πÉ‡∏ô‡∏´‡πâ‡∏≠‡∏á</li>
            <li>4. ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</li>
        </ul>
        <div class="radio-group">
            <label class="radio-option">
                <input type="radio" name="consent" id="consentYes" value="‡∏¢‡∏¥‡∏ô‡∏¢‡∏≠‡∏°">
                <span class="checkmark"></span>
                ‡∏¢‡∏¥‡∏ô‡∏¢‡∏≠‡∏°
            </label>
            <label class="radio-option">
                <input type="radio" name="consent" id="consentNo" value="‡πÑ‡∏°‡πà‡∏¢‡∏¥‡∏ô‡∏¢‡∏≠‡∏°">
                <span class="checkmark"></span>
                ‡πÑ‡∏°‡πà‡∏¢‡∏¥‡∏ô‡∏¢‡∏≠‡∏°
            </label>
        </div>
    </div>

    <button id="btnSubmit" class="btn-submit" onclick="submitBooking()">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</button>
</div>

<script>
    // üî¥üî¥üî¥ ‡πÉ‡∏™‡πà URL ‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà üî¥üî¥üî¥
    const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbxjLE8-Gflxqu7S2s2LF12j0IO1sQo8i5Am_OrVrN3Ast6ZT-o30jXjKZV-UO9N4-ppKQ/exec";

    const BOOKING_DURATION = 180; 

    const BASIC_ROOMS = [
        "Sharing Room (‡∏ä‡∏±‡πâ‡∏ô 1) (‡πÄ‡∏ß‡∏•‡∏≤ 07.30 - 19.00 ‡∏ô.)",
        "The Library Cafe (‡πÄ‡∏•‡πá‡∏Å) ‡∏ä‡∏±‡πâ‡∏ô 2 (‡πÄ‡∏ß‡∏•‡∏≤ 08.30 - 16.30 ‡∏ô.)"
    ];

    const SPECIAL_ROOMS = [
        "Active Learning 1 (‡∏ä‡∏±‡πâ‡∏ô 3) (‡∏Å‡∏•‡∏∏‡πà‡∏° 7 ‡∏Ñ‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ) (‡πÄ‡∏ß‡∏•‡∏≤ 08.30 - 16.30 ‡∏ô.)",
        "Active Learning 2 (‡∏ä‡∏±‡πâ‡∏ô 3) (‡∏Å‡∏•‡∏∏‡πà‡∏° 7 ‡∏Ñ‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ) (‡πÄ‡∏ß‡∏•‡∏≤ 08.30 - 16.30 ‡∏ô.)",
        "Active Learning 3 (‡∏ä‡∏±‡πâ‡∏ô 3) (‡∏Å‡∏•‡∏∏‡πà‡∏° 7 ‡∏Ñ‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ) (‡πÄ‡∏ß‡∏•‡∏≤ 08.30 - 16.30 ‡∏ô.)",
        "Activity Room 3 (‡∏ä‡∏±‡πâ‡∏ô 4) (‡∏Å‡∏•‡∏∏‡πà‡∏° 7 ‡∏Ñ‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ) (‡πÄ‡∏ß‡∏•‡∏≤ 08.30 - 16.30 ‡∏ô.)",
        "Activity Room 4 (‡∏ä‡∏±‡πâ‡∏ô 4) (‡∏Å‡∏•‡∏∏‡πà‡∏° 7 ‡∏Ñ‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ) (‡πÄ‡∏ß‡∏•‡∏≤ 08.30 - 16.30 ‡∏ô.)"
    ];

    const ROOM_CONFIG = {
        "Sharing Room (‡∏ä‡∏±‡πâ‡∏ô 1) (‡πÄ‡∏ß‡∏•‡∏≤ 07.30 - 19.00 ‡∏ô.)": { start: 450, end: 1140 },
        "The Library Cafe (‡πÄ‡∏•‡πá‡∏Å) ‡∏ä‡∏±‡πâ‡∏ô 2 (‡πÄ‡∏ß‡∏•‡∏≤ 08.30 - 16.30 ‡∏ô.)": { start: 510, end: 990 },
        "Active Learning 1 (‡∏ä‡∏±‡πâ‡∏ô 3) (‡∏Å‡∏•‡∏∏‡πà‡∏° 7 ‡∏Ñ‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ) (‡πÄ‡∏ß‡∏•‡∏≤ 08.30 - 16.30 ‡∏ô.)": { start: 510, end: 990 },
        "Active Learning 2 (‡∏ä‡∏±‡πâ‡∏ô 3) (‡∏Å‡∏•‡∏∏‡πà‡∏° 7 ‡∏Ñ‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ) (‡πÄ‡∏ß‡∏•‡∏≤ 08.30 - 16.30 ‡∏ô.)": { start: 510, end: 990 },
        "Active Learning 3 (‡∏ä‡∏±‡πâ‡∏ô 3) (‡∏Å‡∏•‡∏∏‡πà‡∏° 7 ‡∏Ñ‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ) (‡πÄ‡∏ß‡∏•‡∏≤ 08.30 - 16.30 ‡∏ô.)": { start: 510, end: 990 },
        "Activity Room 3 (‡∏ä‡∏±‡πâ‡∏ô 4) (‡∏Å‡∏•‡∏∏‡πà‡∏° 7 ‡∏Ñ‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ) (‡πÄ‡∏ß‡∏•‡∏≤ 08.30 - 16.30 ‡∏ô.)": { start: 510, end: 990 },
        "Activity Room 4 (‡∏ä‡∏±‡πâ‡∏ô 4) (‡∏Å‡∏•‡∏∏‡πà‡∏° 7 ‡∏Ñ‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ) (‡πÄ‡∏ß‡∏•‡∏≤ 08.30 - 16.30 ‡∏ô.)": { start: 510, end: 990 }
    };
    
    let dbBookings = [];
    let selectedStart = null;

    function handleStatusChange() {
        const status = document.getElementById('inpStatus').value;
        const yearGroup = document.getElementById('yearGroup');
        const roomSelect = document.getElementById('inpRoom');
        
        if (status === '‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤') {
            yearGroup.style.display = 'block';
        } else {
            yearGroup.style.display = 'none';
            document.getElementById('inpYear').value = '';
        }

        roomSelect.innerHTML = ''; 
        let availableRooms = [...BASIC_ROOMS];
        if (status === '‡∏≠‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå' || status === '‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà') {
            availableRooms = availableRooms.concat(SPECIAL_ROOMS);
        }

        availableRooms.forEach(roomName => {
            const option = document.createElement('option');
            option.value = roomName;
            option.text = roomName;
            roomSelect.appendChild(option);
        });

        fetchData();
    }

    function minToStr(min) {
        let h = Math.floor(min/60), m = min%60;
        return `${h.toString().padStart(2,'0')}:${m.toString().padStart(2,'0')}`;
    }

    async function fetchData() {
        document.getElementById('loading').style.display = 'block';
        document.getElementById('grid').innerHTML = '';
        document.getElementById('preview').style.display = 'none';
        try {
            const res = await fetch(WEB_APP_URL);
            dbBookings = await res.json();
            renderGrid();
        } catch (e) { alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•"); console.error(e); }
        finally { document.getElementById('loading').style.display = 'none'; }
    }

    function renderGrid() {
        const room = document.getElementById('inpRoom').value;
        const cfg = ROOM_CONFIG[room];
        const container = document.getElementById('grid');
        container.innerHTML = '';
        selectedStart = null; 
        document.getElementById('preview').style.display = 'none';

        const lastBookableTime = cfg.end - BOOKING_DURATION;

        for(let m = cfg.start; m <= lastBookableTime; m += 30) {
            const isBooked = dbBookings.filter(b => b.room === room).some(b => m >= b.startMin && m < b.endMin);
            
            const btn = document.createElement('div');
            btn.className = `time-slot ${isBooked ? 'disabled' : ''}`;
            btn.innerText = minToStr(m);
            if(!isBooked) btn.onclick = () => selectTime(m);
            container.appendChild(btn);
        }
    }

    function selectTime(start) {
        selectedStart = start;
        const end = start + BOOKING_DURATION;
        const room = document.getElementById('inpRoom').value;
        
        document.querySelectorAll('.time-slot').forEach(b => b.classList.remove('selected', 'range'));

        if(dbBookings.filter(b => b.room === room).some(b => start < b.endMin && end > b.startMin)) {
            alert("‡∏°‡∏µ‡∏Ñ‡∏ô‡∏à‡∏≠‡∏á‡∏ï‡∏±‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏£‡∏±‡∏ö!"); fetchData(); return;
        }

        document.querySelectorAll('.time-slot').forEach(btn => {
            let t = parseInt(btn.innerText.split(':')[0])*60 + parseInt(btn.innerText.split(':')[1]);
            if(t === start) btn.classList.add('selected');
            if(t > start && t < end) btn.classList.add('range');
        });
        const preview = document.getElementById('preview');
        preview.style.display = 'block';
        preview.innerText = `‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤: ${minToStr(start)} - ${minToStr(end)}`;
    }

    function submitBooking() {
        const name = document.getElementById('inpName').value;
        const phone = document.getElementById('inpPhone').value;
        const status = document.getElementById('inpStatus').value;
        const year = document.getElementById('inpYear').value;
        const faculty = document.getElementById('inpFaculty').value;
        const room = document.getElementById('inpRoom').value;
        const users = document.getElementById('inpUsers').value;
        const usage = document.getElementById('inpUsage').value;
        
        const consentYes = document.getElementById('consentYes').checked;
        const consentNo = document.getElementById('consentNo').checked;

        if(!name || !phone || !status || !faculty || !selectedStart || !users || !usage) { 
            alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏≠‡∏á (‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢ *)"); return; 
        }
        
        if(!consentYes && !consentNo) { alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ‡∏¢‡∏¥‡∏ô‡∏¢‡∏≠‡∏° ‡∏´‡∏£‡∏∑‡∏≠ ‡πÑ‡∏°‡πà‡∏¢‡∏¥‡∏ô‡∏¢‡∏≠‡∏°"); return; }
        if(consentNo) { alert("‡∏ï‡πâ‡∏≠‡∏á‡∏¢‡∏¥‡∏ô‡∏¢‡∏≠‡∏°‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡∏à‡∏∂‡∏á‡∏à‡∏∞‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÑ‡∏î‡πâ"); return; }

        const btn = document.getElementById('btnSubmit');
        btn.disabled = true; btn.innerText = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...";

        const end = selectedStart + BOOKING_DURATION;
        const uniqueId = Date.now().toString();

        const formData = new FormData();
        formData.append('id', uniqueId);
        formData.append('name', name);
        formData.append('phone', phone);
        formData.append('status', status);
        formData.append('year', year);
        formData.append('faculty', faculty);
        formData.append('room', room);
        formData.append('startMin', selectedStart);
        formData.append('endMin', end);
        formData.append('timeRange', `${minToStr(selectedStart)} - ${minToStr(end)}`);
        formData.append('users', users);
        formData.append('usage', usage);
        formData.append('consent', '‡∏¢‡∏¥‡∏ô‡∏¢‡∏≠‡∏°');

        fetch(WEB_APP_URL, { method: 'POST', body: formData })
        .then(res => res.json())
        .then(data => {
            if(data.result === 'success') {
                alert("‚úÖ ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!"); window.location.reload();
            } else {
                alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î"); btn.disabled = false; btn.innerText = "‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô";
            }
        })
        .catch(err => {
            alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠"); btn.disabled = false; btn.innerText = "‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô";
        });
    }

    fetchData();
</script>
</body>
</html>